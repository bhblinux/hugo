* 安装
* 使用

1. 声明浏览器对象
  #+BEGIN_SRC 
  from selenium import webdriver
  browser=webdriver.Chrome()
  browser=webdriver.Firefox()
  #+END_SRC
2. 访问页面
   #+BEGIN_SRC 
   browser.get("http://www.baidu.com")
   browser.close()#关闭浏览器
   #+END_SRC
3. 查找元素
   1. 单个元素查找
      #+BEGIN_SRC 
      from selenium.webdriver.common.by import By
      browser.find_element_by_id("id_name")  #id查找
      browser.find_element_by_css_selector("#q")#类选择器
      browser.find_element_by_xpath("")
      ...
      find_element_by_name
      find_element_by_link_text
      find_element_by_partial_link_text
      find_element_by_tag_name
      find_element_by_class_name
      方式二
      browser.find_emement(By.ID,"q")
      #+END_SRC
   2. 多元素查找
      #+BEGIN_SRC 
      find_elements_by_css_selector('.service_by li')
      #+END_SRC
4. 元素交互操作
   #官方文档 https://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.common.action_chains
   #+BEGIN_SRC 
   input.send_keys('内容')#输入框发送字符
   input.clear()#清空输入框
   button.click()#按钮点击
   #+END_SRC
5. 交互动作
   #拖拽
   #+BEGIN_SRC 
   from selenium import webdriver
   from selenium.webdriver import ActionChains
   browser = webdriver.Firefox()
   url = "http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable"
   browser.get(url)
   browser.switch_to.frame('iframeResult')
   source = browser.find_element_by_css_selector('#draggable')
   target = browser.find_element_by_css_selector('#droppable')
   actions = ActionChains(browser)
   actions.drag_and_drop(source, target)
   actions.perform()
   #+END_SRC
6. 执行js
   #+BEGIN_SRC 
   from selenium import webdriver
   browser=webdriver.Firefox()
   browser.get("http://zhihu.com/explore")
   browser.execute_script('window.scrollTo(0, document.body.scrollHeight)')
   browser.execute_script('alert("To Bottom")')
   #+END_SRC
7. 获取元素属性
   # get_attribute('class')
   #+BEGIN_SRC 
   from selenium import webdriver
   browser = webdriver.Chrome()
   url = 'https://www.zhihu.com/explore'
   browser.get(url)
   logo = browser.find_element_by_id('zh-top-link-logo')
   print(logo)
   print(logo.get_attribute('class'))
   #+END_SRC
8. 获取文本
   #+BEGIN_SRC 
   input.text
   #+END_SRC
9. 获取id,位置,标签名
   #+BEGIN_SRC 
   id,location,tag_name,size
   #+END_SRC
10. Frame
    1. switch_to_frame()
       #+BEGIN_SRC 
       switch_to_frame('iframename')
       #+END_SRC
    2. switch_to.parent_frame()
11. 等待
    1.隐式等待
    #+BEGIN_SRC 
    browser.implicitly_wait(10)
    #+END_SRC
    2.显示等待
    
    #+BEGIN_SRC 
    from selenium import webdriver
    from selenium.webdriver.common.by import By
    from selenium.webdriver.support.ui import WebDriverWait
    from selenium.webdriver.support import expected_conditions as EC
    browser = webdriver.Chrome()
    browser.get('https://www.taobao.com/')
    wait = WebDriverWait(browser, 10)
    input = wait.until(EC.presence_of_element_located((By.ID, 'q')))
    button = wait.until(EC.element_to_be_clickable((By.CSS_SELECTOR, '.btn-search')))
    print(input, button)
    #+END_SRC
12. 浏览器的前进和后退
    back()
    forward()
13. cooike操作
    get_cookies()
    delete_all_cookies()
    add_cookie()
14. 选项卡管理
    #+BEGIN_SRC 
    import time
    from selenium import webdriver

    browser = webdriver.Chrome()
    browser.get('https://www.baidu.com')
    browser.execute_script('window.open()')
    print(browser.window_handles)
    browser.switch_to_window(browser.window_handles[1])
    browser.get('https://www.taobao.com')
    time.sleep(1)
    browser.switch_to_window(browser.window_handles[0])
    browser.get('https://python.org')
    #+END_SRC
15. 异常处理
    #+BEGIN_SRC 
    from selenium import webdriver
    from selenium.common.exceptions import TimeoutException, NoSuchElementException

    browser = webdriver.Chrome()
    try:
        browser.get('https://www.baidu.com')
    except TimeoutException:
        print('Time Out')
    try:
        browser.find_element_by_id('hello')
    except NoSuchElementException:
        print('No Element')
    finally:
        browser.close()
    #+END_SRC
* 拓展
